define(["THREE", "ModelGenerator/interface/Font", "ModelGenerator/utils/CurveBaked"],function(THREE,Font,Curve){

	var linearCurve = function(vecs,closed){
			
			//points to return
			this.points = [];

			var close = closed ? true:false;

			//one dimensional array of vectors
			this.vecs = cloneArray(vecs) || [];

			if(close)
				this.vecs.push(this.vecs[0].clone());

			//total length
			this.lineLength = 0;
			
			for(var i = 0 ; i < this.vecs.length ; i++){
				if(i>0){
					this.vecs[i-1].dist = this.vecs[i-1].distanceTo(this.vecs[i]);
				}
			};

			// this.setDistance = function(arr){

			// 	var num = arr.length/this.vecs.length;

			// 	var distances = [];

			// 	for(var i = 0 ; i < arr.length ; i++){
			// 		if(i>0){
			// 			distances[i-1] = arr[i-1].distanceTo(arr[i]);
			// 		}
			// 	};

			// 	for(var i = 0 ; i < this.vecs.length ; i++){
			// 		if(i>0){
			// 			this.vecs[i-1].cPos = this.lerp(distances[i-1],;
			// 		}
			// 	};

			// };
			
			this.getLength = function(){
				for(var i = 0 ; i < this.vecs.length-1 ; i++){
					this.lineLength+=this.vecs[i].dist;
				}
				return this.lineLength;
			};
			
			this.lineLength = this.getLength();

			this.getSpacedPoints = function(amt){

				this.points = [];

				var len = this.lineLength;
						
				for(var i = 0 ; i < this.vecs.length-1 ; i++){
					for(var j = 0 ; j < (this.vecs[i].dist/len)*amt ; j++){
						var v = this.vecs[i].clone();
						v.lerp(this.vecs[i+1],j/((this.vecs[i].dist/len)*amt));
						this.points.push(v);
					}
				}
				return this.points;
			};
			
			this.getEvenPoints = function(amt){

				this.points = [];
				
				var len = this.lineLength;
				
				// console.log(this.vecs[0].dist/len);
				
				for(var i = 0 ; i < this.vecs.length-1 ; i++){
					for(var j = 0 ; j < amt ; j++){
						var v = this.vecs[i].clone();
						v.lerp(this.vecs[i+1],j/amt);
						this.points.push(v);
					}
				}
				return this.points;
			};
			
			//points are spaced evenly across the entire curve
			this.getPointAt = function(t){

				if(t>1)
					t=1;
				if(t<0)
					t=0;

				var total = 0;
				for(var i = 0 ; i < this.vecs.length-1 ;){
					if(total+this.vecs[i].dist<t*this.lineLength){ total+=this.vecs[i].dist;i++;}
					else{
						thisT2 = THREE.Math.mapLinear(t*this.lineLength,total,total+this.vecs[i].dist,0,1);
						var v = this.vecs[i].clone();
						v.lerp(this.vecs[i+1],thisT2);
						v.cPos = total+(thisT2*vecs[i].dist);
						return v;
					}
				}
			};

			//points are spaced equally between vertices
			this.getEvenPointAt = function(t){

				if(t>1)
					t=1;
				if(t<0)
					t=0;

				var t2=t*(this.vecs.length-1);
				
				var total = 0;
				for(var i = 1 ; i < this.vecs.length ;){
					if(total+1<t2){total+=1;i++;}
					else{
						thisT2 = THREE.Math.mapLinear(t2,total,total+1,0,1);
						var v = this.vecs[i-1].clone();
						v.lerp(this.vecs[i],thisT2);
						v.cPos = total+thisT2;
						return v;
					}
				}
			};
		};

	var cloneArray = function(arr){
		var r = [];

		for(var i = 0 ; i < arr.length ; i++){
			r.push(arr[i]);
		}

		return r;
	}


	return {

		linearCurve:linearCurve,

		checkLength : function(arr,scalar,height) {

			var layerHeight = height || 0.27;

			var output = ";FLAVOR:UltiGCode\n;TIME:1081      \n;MATERIAL:1177      \n;MATERIAL2:0         \n\n;Layer count: 170\n;LAYER:0\nM107\nG1 F1200 X20.360 Y20.859 Z0.300 E-2.0\n;TYPE:WALL-OUTER\n";

			var E = 0.0;
			var D = 0.0;

			for(var i = 0 ; i < arr.length ; i++){

				for(j = 0 ; j < arr[i].length ; j++){

					var vec = arr[i][j];

					var eValue = 0;

					if(j>0){

						var dist = arr[i][j-1].distanceTo(arr[i][j]);
						D+=dist;
						eValue = .4 * dist * layerHeight;

					}

					E+=eValue;

					var X = arr[i][j].x + 110;
					var Y = arr[i][j].y + 110;
					var Z = arr[i][j].z + layerHeight;

					output+="G1 X" + X;
					output+=" Y"  +  Y;
					output+=" Z"  +  Z;
					output+=" E"  + E;
					output+='\n';
					
				}	
				  
			}
			
			console.log("total volume is: " + E + " cubic millimeters");
			console.log("total length is: " + D + " millimeters");
		},
		
		ruler : function(w,h){

			var ruler = new THREE.Object3D();

			var ob = new THREE.SphereGeometry( 0.5 );
			var mat = new THREE.MeshLambertMaterial( );

			for (var i = 0; i < w; i++) {

				for(var j = 0 ; j < h ; j++){
					var dot = new THREE.Mesh(ob,mat);
					dot.position = new THREE.Vector3((i-(w/2))*10,j*10,0);
					ruler.add(dot);

					if(i==0){
						var tGeo = new THREE.TextGeometry( ""+j+"", {font:"helvetiker",size:3,height:1} );
						var text = new THREE.Mesh(tGeo,mat);
						text.position = new THREE.Vector3((w/2)*10,j*10,0);
						ruler.add(text);
					}
				}

				var tGeo = new THREE.TextGeometry( ""+i-w/2+"", {font:"helvetiker",size:3,height:1} );
				var text = new THREE.Mesh(tGeo,mat);
				text.position = new THREE.Vector3((i-(w/2))*10,0,0);
				ruler.add(text);
				
			}


			ruler.visible = false;
			return ruler;

		},

		lerp:function(a,b,t){
			return a + ((b-a)*t);
		},

	    arrayToVecs:function(arr){

	    	var r = [];

	    	for(var i = 0 ; i < arr.length ; i++){
	    		r.push(new THREE.Vector3(i,arr[i],0));
	    	}
	        
	        return r;
	    },

	    JSONSongToCurves:function(obj){
	    	this.songCurves = [];
	    },

		Wave:function(){

			this.cosPoints = [
				new THREE.Vector3(0,-1,0),
				new THREE.Vector3(Math.PI,1,0),
				new THREE.Vector3(Math.PI*2,-1,0),
			];
			this.sinPoints = [
				new THREE.Vector3(0,0,0),
				new THREE.Vector3(Math.PI/2,1,0),
				new THREE.Vector3(Math.PI,0,0),
				new THREE.Vector3((3/2)*Math.PI,-1,0),
				new THREE.Vector3(Math.PI*2,0,0),
			];
			this.squarePoints = [
				new THREE.Vector3(0,-1,0),
				new THREE.Vector3(0,1,0),
				new THREE.Vector3(Math.PI,1,0),
				new THREE.Vector3(Math.PI,-1,0),
				new THREE.Vector3(Math.PI*2,-1,0),
			];
			this.sawPoints = [
				new THREE.Vector3(0,-1,0),
				new THREE.Vector3(0,1,0),
				new THREE.Vector3(Math.PI*2,-1,0),
			];

			this.cosCurve = new linearCurve(this.cosPoints);
			this.sinCurve = new linearCurve(this.sinPoints);
			this.squareCurve = new linearCurve(this.squarePoints);
			this.sawCurve = new linearCurve(this.sawPoints);

			this.TriCos = function(t){

				return this.cosCurve.getPointAt((t%(Math.PI*2))/(Math.PI*2)).y;

			};

			this.TriSin = function(t){

				return this.sinCurve.getPointAt((t%(Math.PI*2))/(Math.PI*2)).y;

			};

			this.Square = function(t){

				return this.squareCurve.getPointAt((t%(Math.PI*2))/(Math.PI*2)).y;

			};

			this.Saw = function(t){

				return this.sawCurve.getPointAt((t%(Math.PI*2))/(Math.PI*2)).y;

			};
		},

		comboWave:function(t,l){

			var wave = new this.Wave();

			var out = 0;

			while(t>Math.PI*2)
		        t-=Math.PI*2;
		    while(t<0)
		        t+=Math.PI*2;

			var sin = Math.sin(t);
			var tri = wave.TriSin(t);
			var saw = wave.Saw(t);
			var square = wave.Square(t);

			var div = 1/3;
			var div2 = 2/3;

			if(l!=0){
				if(l<div)
					out = this.lerp(sin,tri,THREE.Math.mapLinear(l,0,div,0,1));
				else if(l>div&&l<div2)
					out = this.lerp(tri,saw,THREE.Math.mapLinear(l,div,div2,0,1));
				else
					out = this.lerp(saw,square,THREE.Math.mapLinear(l,div2,1,0,1));
			}

			if(l==0)
				return Math.sin(t);
			else
				return out;

		},

		findAngle: function(p0,p1,c) {
		    var p0c = Math.sqrt(Math.pow(c.x-p0.x,2)+
		                        Math.pow(c.y-p0.y,2)); // p0->c (b)   
		    var p1c = Math.sqrt(Math.pow(c.x-p1.x,2)+
		                        Math.pow(c.y-p1.y,2)); // p1->c (a)
		    var p0p1 = Math.sqrt(Math.pow(p1.x-p0.x,2)+
		                         Math.pow(p1.y-p0.y,2)); // p0->p1 (c)
		    var r = Math.acos((p1c*p1c+p0c*p0c-p0p1*p0p1)/(2*p1c*p0c));
		    if(isNaN(r))
		    	return Math.PI;
		    else
		    	return r;
		},

		bakedWave:function(t,l){

			// var curves = [[-1,-0.9930955520692771,-0.9861911041385542,-0.9792866562078313,-0.9723822082771085,-0.9654777603463857,-0.9585733124156627,-0.9516688644849398,-0.9447644165542171,-0.9378599686234942,-0.9309555206927712,-0.9240510727620483,-0.9171466248313256,-0.9102421769006025,-0.9033377289698797,-0.8964332810391569,-0.8895288331084341,-0.8826243851777111,-0.8757199372469883,-0.8688154893162654,-0.8619110413855424,-0.8550065934548196,-0.8481021455240967,-0.8411976975933739,-0.8342932496626512,-0.8273888017319282,-0.8204843538012052,-0.8135799058704825,-0.8066754579397595,-0.7997710100090367,-0.7928665620783137,-0.785962114147591,-0.779057666216868,-0.7721532182861451,-0.7652487703554222,-0.7583443224246993,-0.7514398744939765,-0.7445354265632537,-0.7376309786325308,-0.730726530701808,-0.7238220827710851,-0.716917634840362,-0.7100131869096391,-0.7031087389789163,-0.6962042910481936,-0.6892998431174707,-0.6823953951867479,-0.6754909472560249,-0.6685864993253021,-0.661682051394579,-0.6547776034638563,-0.6478731555331334,-0.6409687076024105,-0.6340642596716878,-0.6271598117409649,-0.6202553638102419,-0.6133509158795188,-0.6064464679487962,-0.5995420200180733,-0.5926375720873505,-0.5857331241566276,-0.5788286762259048,-0.571924228295182,-0.565019780364459,-0.5581153324337359,-0.5512108845030131,-0.5443064365722903,-0.5374019886415673,-0.5304975407108445,-0.5235930927801217,-0.5166886448493987,-0.5097841969186759,-0.5028797489879532,-0.4959753010572301,-0.48907085312650733,-0.48216640519578446,-0.4752619572650615,-0.4683575093343386,-0.46145306140361586,-0.4545486134728929,-0.44764416554217,-0.44073971761144726,-0.43383526968072417,-0.4269308217500015,-0.42002637381927854,-0.41312192588855545,-0.4062174779578328,-0.39931303002711005,-0.3924085820963873,-0.3855041341656642,-0.37859968623494145,-0.37169523830421836,-0.3647907903734956,-0.35788634244277273,-0.35098189451204975,-0.344077446581327,-0.3371729986506041,-0.33026855071988104,-0.3233641027891583,-0.3164596548584355,-0.30955520692771255,-0.30265075899698957,-0.29574631106626703,-0.28884186313554383,-0.2819374152048211,-0.2750329672740983,-0.26812851934337534,-0.26122407141265236,-0.2543196234819296,-0.2474151755512066,-0.24051072762048384,-0.23360627968976108,-0.22670183175903788,-0.21979738382831512,-0.21289293589759237,-0.2059884879668694,-0.19908404003614663,-0.19217959210542365,-0.1852751441747009,-0.1783706962439777,-0.17146624831325516,-0.1645618003825324,-0.15765735245180965,-0.15075290452108622,-0.1438484565903639,-0.1369440086596407,-0.13003956072891795,-0.1231351127981952,-0.11623066486747177,-0.10932621693674902,-0.10242176900602626,-0.0955173210753035,-0.08861287314458052,-0.08170842521385777,-0.07480397728313457,-0.06789952935241181,-0.06099508142168905,-0.05409063349096607,-0.047186185560243316,-0.04028173762952056,-0.03337728969879736,-0.0264728417680746,-0.019568393837351844,-0.012663945906629087,-0.00575949797590633,0.0011449499548166486,0.00804939788553985,0.014953845816262606,0.02185829374698539,0.028762741677708148,0.03566718960843113,0.042571637539153884,0.049476085469877085,0.05638053340059984,0.06328498133132282,0.07018942926204558,0.07709387719276833,0.08399832512349109,0.09090277305421429,0.09780722098493727,0.10471166891566003,0.11161611684638256,0.11852056477710554,0.1254250127078283,0.13232946063855172,0.13923390856927448,0.146138356499997,0.15304280443072,0.15994725236144297,0.16685170029216573,0.17375614822288915,0.18066059615361169,0.18756504408433444,0.1944694920150572,0.20137393994577996,0.2082783878765027,0.21518283580722547,0.2220872837379489,0.22899173166867165,0.2358961795993944,0.24280062753011716,0.24970507546083992,0.25660952339156334,0.2635139713222861,0.27041841925300886,0.27732286718373184,0.2842273151144546,0.29113176304517735,0.29803621097590055,0.3049406589066233,0.31184510683734606,0.31874955476806904,0.3256540026987918,0.33255845062951456,0.339462898560238,0.35158848139098003,0.36877611462888243,0.38596374786678483,0.40315138110468723,0.4203390143425905,0.4375266475804925,0.4547142808183949,0.4719019140562973,0.4890895472941997,0.5062771805321016,0.5234648137700035,0.5406524470079068,0.5578400802458092,0.5750277134837116,0.5922153467216145,0.6094029799595164,0.6265906131974188,0.6437782464353217,0.6609658796732241,0.6781535129111269,0.6953411461490289,0.7125287793869313,0.7297164126248337,0.7469040458627365,0.7640916791006385,0.7812793123385413,0.7984669455764437,0.8156545788143461,0.8328422120522494,0.8500298452901514,0.8672174785280538,0.8844051117659562,0.9015927450038586,0.9187803782417614,0.9359680114796634,0.9531556447175662,0.9703432779554686,0.987530911193371,0.9985687971916868,0.9933555393074731,0.9881422814232599,0.9829290235390464,0.9777157656548332,0.9725025077706193,0.9672892498864061,0.9620759920021928,0.9568627341179794,0.951649476233766,0.9464362183495525,0.9412229604653393,0.9360097025811258,0.9307964446969121,0.9255831868126989,0.9203699289284857,0.9151566710442722,0.9099434131600586,0.9047301552758451,0.8995168973916319,0.8943036395074182,0.889090381623205,0.8838771237389915,0.8786638658547781,0.8734506079705646,0.8682373500863512,0.8630240922021379,0.8578108343179245,0.8525975764337113,0.8473843185494976,0.8421710606652841,0.8369578027810709,0.8317445448968572,0.826531287012644,0.8213180291284305,0.8161047712442171,0.8108915133600036,0.8056782554757902,0.800464997591577,0.7952517397073635,0.7900384818231503,0.7848252239389366,0.7796119660547232,0.7743987081705099,0.7691854502862963,0.763972192402083,0.7587589345178696,0.7535456766336561,0.7483324187494427,0.7431191608652294,0.7379059029810162,0.7326926450968028,0.7274793872125893,0.7222661293283759,0.7170528714441624,0.7118396135599492,0.7066263556757355,0.7014130977915223,0.6961998399073088,0.6909865820230952,0.6857733241388821,0.6805600662546685,0.6753468083704552,0.6701335504862418,0.6649202926020283,0.6597070347178149,0.6544937768336014,0.6492805189493882,0.6440672610651745,0.6388540031809613,0.6336407452967479,0.6284274874125342,0.6232142295283212,0.6180009716441075,0.6127877137598943,0.6075744558756808,0.6023611979914674,0.5971479401072539,0.5919346822230405,0.5867214243388272,0.5815081664546136,0.5762949085704003,0.5710816506861869,0.5658683928019732,0.56065513491776,0.5554418770335465,0.5502286191493333,0.5450153612651198,0.539802103380906,0.5345888454966932,0.5293755876124795,0.524162329728266,0.5189490718440526,0.5137358139598394,0.5085225560756259,0.5033092981914122,0.4980960403071993,0.4928827824229856,0.48766952453877194,0.48245626665455893,0.4772430087703455,0.472029750886132,0.4668164930019186,0.4616032351177051,0.4563899772334917,0.45117671934927844,0.44596346146506477,0.4407502035808511,0.4355369456966383,0.43032368781242464,0.4251104299282114,0.41989717204399796,0.41468391415978495,0.4094706562755713,0.4042573983913578,0.3990441405071446,0.39383088262293114,0.3886176247387177,0.3834043668545038,0.37819110897029123,0.37297785108607734,0.3677645932018639,0.36255133531765066,0.357338077433437,0.352124819549224,0.3469115616650103,0.34169830378079663,0.3364850458965836,0.33127178801236973,0.32605853012815716,0.32084527224394327,0.3156320143597298,0.31041875647551637,0.3052054985913029,0.2999922407070897,0.294778982822876,0.289565724938663,0.2843524670544491,0.2791392091702361,0.27392595128602265,0.268712693401809,0.26349943551759575,0.2582861776333823,0.25307291974916885,0.2478596618649554,0.24264640398074194,0.2374331460965285,0.23221988821231548,0.2270066303281016,0.22179337244388836,0.21658011455967469,0.21136685667546168,0.206153598791248,0.20094034090703478,0.19572708302282132,0.19051382513860743,0.18530056725439487,0.18008730937018097,0.17487405148596752,0.16966079360175407,0.16444753571754062,0.1592342778333274,0.1540210199491137,0.1488077620649007,0.14359450418068703,0.13838124629647336,0.13316798841226057,0.12795473052804668,0.12274147264383345,0.11752821475962,0.11231495687540655,0.1071016989911931,0.10188844110697964,0.09667518322276641,0.09146192533855318,0.08624866745433973,0.08103540957012606,0.07582215168591327,0.07060889380169938,0.06539563591748593,0.0601823780332727,0.05496912014905925,0.04975586226484602,0.04454260438063257,0.03932934649641889,0.03411608861220522,0.028902830727992435,0.02368957284377876,0.01847631495956531,0.01326305707535208,0.008049799191138407,0.0028365413069249557,-0.002376716577288218,-0.0075899744615016695,-0.012803232345714899,-0.018016490229928794,-0.02322974811414158,-0.028443005998355253,-0.033656263882568704,-0.038869521766782156,-0.04408277965099561,-0.049296037535208836,-0.05450929541942229,-0.05972255330363596,-0.06493581118784941,-0.07014906907206242,-0.07536232695627587,-0.08057558484048954,-0.085788842724703,-0.09100210060891623,-0.0962153584931299,-0.10142861637734313,-0.10664187426155658,-0.11185513214577048,-0.11706839002998304,-0.12228164791419693,-0.12749490579841016,-0.13270816368262361,-0.13792142156683684,-0.14313467945105052,-0.14834793733526397,-0.1535611952194772,-0.15877445310369087,-0.16398771098790432,-0.16920096887211733,-0.17441422675633078,-0.17962748464054445,-0.1848407425247579,-0.19005400040897114,-0.1952672582931846,-0.20048051617739782,-0.2056937740616115,-0.21090703194582516,-0.21612028983003795,-0.2213335477142514,-0.22654680559846507,-0.23176006348267808,-0.23697332136689153,-0.24218657925110498,-0.24739983713531866,-0.2526130950195321,-0.2578263529037451,-0.26303961078795857,-0.2682528686721727,-0.27346612655638525,-0.27867938444059914,-0.28389264232481215,-0.2891059002090258,-0.2943191580932393,-0.2995324159774527,-0.3047456738616664,-0.3099589317458794,-0.31517218963009286,-0.3203854475143063,-0.3255987053985193,-0.330811963282733,-0.33602522116694644,-0.3412384790511599,-0.34645173693537357,-0.351664994819587,-0.3568782527038,-0.3620915105880135,-0.3673047684722276,-0.37251802635643994,-0.37773128424065405,-0.38294454212486706,-0.3881578000090805,-0.3933710578932942,-0.388301130470328,-0.383231203047362,-0.37816127562439517,-0.3730913482014292,-0.368021420778463,-0.3629514933554968,-0.35788156593253084,-0.3528116385095642,-0.347741711086598,-0.3426717836636327,-0.33760185624066674,-0.33253192881770055,-0.3274620013947339,-0.3223920739717677,-0.31732214654880175,-0.31225221912583556,-0.3071822917028689,-0.30211236427990273,-0.29704243685693676,-0.2919725094339706,-0.2869025820110044,-0.28183265458803775,-0.2767627271650718,-0.2716927997421056,-0.2666228723191394,-0.2615529448961735,-0.25648301747320684,-0.25141309005024154,-0.24634316262727535,-0.24127323520430938,-0.23620330778134319,-0.23113338035837655,-0.22606345293541036,-0.2209935255124444,-0.2159235980894782,-0.210853670666512,-0.20578374324354537,-0.2007138158205794,-0.1956438883976132,-0.19057396097464702,-0.18550403355168038,-0.1804341061287142,-0.17536417870574822,-0.17029425128278203,-0.16522432385981584,-0.1601543964368492,-0.15508446901388412,-0.15001454159091793,-0.14494461416795174,-0.13987468674498577,-0.13480475932201913,-0.12973483189905294,-0.12466490447608675,-0.11959497705312078,-0.11452504963015459,-0.10945512220718795,-0.10438519478422176,-0.09931526736125579,-0.09424533993828962,-0.08917541251532343,-0.0841054850923568,-0.07903555766939083,-0.07396563024642597,-0.06889570282345978,-0.06382577540049314,-0.05875584797752695,-0.05368592055456098,-0.04861599313159479,-0.043546065708628595,-0.03847613828566196,-0.03340621086269577,-0.028336283439729798,-0.023266356016763606,-0.018196428593797415,-0.013126501170830793,-0.008056573747864823,-0.0029866463248986314,0.0020832810980675603,0.007153208521032642,0.012223135943999278,0.01729306336696547,0.02236299078993166,0.027432918212897624,0.032502845635863815,0.03757277305883045,0.04264270048179664,0.047712627904762606,0.0527825553277288,0.05785248275069543,0.06292241017366162,0.0679923375966276,0.07306226501959379,0.07813219244255998,0.08320211986552661,0.08827204728849258,0.09334197471145878,0.09841190213442497,0.10348182955739005,0.10855175698035667,0.11362168440332286,0.11869161182628905,0.12376153924925502,0.12883146667222123,0.13390139409518786,0.13897132151815406,0.14404124894112003,0.14911117636408622,0.15418110378705238,0.15925103121001902,0.1643209586329852,0.16939088605595118,0.17446081347891737,0.179530740901884,0.1846006683248502,0.18967059574781617,0.19474052317078147,0.19981045059374744,0.20488037801671408,0.20995030543968027,0.21502023286264646,0.22009016028561265,0.22516008770857884,0.23023001513154548,0.2352999425545112,0.2403698699774774,0.24543979740044358,0.2505097248234098,0.2555796522463764,0.2606495796693426,0.2657195070923088,0.27078943451527454,0.27585936193824073,0.28092928936120737,0.28599921678417356,0.29106914420713886,0.29613907163010506,0.30120899905307125,0.3062789264760379,0.3113488538990041,0.3164187813219698,0.321488708744936,0.32655863616790265,0.33162856359086884,0.3366984910138346,0.3417684184368012,0.3468383458597674,0.35190827328273405,0.3569782007056998,0.362048128128666,0.3671180555516322,0.3721879829745988,0.377257910397565,0.38232783782052987,0.3873977652434965,0.39246769266646225,0.3975376200894284,0.402607547512395,0.4076774749353612,0.4127474023583274,0.4178173297812936,0.4228872572042598,0.42795718462722643,0.4330271120501922,0.43809703947315837,0.44316696689612456,0.4482368943190912,0.4533068217420574,0.4583767491650236,0.46344667658798977,0.4685166040109555,0.47358653143392215,0.47865645885688746,0.4837263862798532,0.48879631370281984,0.49386624112578603,0.49893616854875267,0.5040060959717189,0.509076023394685,0.5141459508176508,0.5192158782406174,0.5242858056635836,0.5293557330865494,0.534425660509516,0.5394955879324822,0.5445655153554484,0.549635442778415,0.5547053702013808,0.5597752976243456,0.5648452250473118,0.5699151524702785,0.5749850798932447,0.5800550073162108,0.5851249347391775,0.5901948621621432,0.5900436546850915,0.5848303968008771,0.5796171389166637,0.5744038810324502,0.5691906231482368,0.5639773652640238,0.5587641073798103,0.553550849495596,0.5483375916113834,0.5431243337271708,0.5379110758429565,0.532697817958743,0.5274845600745296,0.5222713021903161,0.5170580443061027,0.5118447864218897,0.5066315285376753,0.5014182706534623,0.49620501276924933,0.4909917548850359,0.48577849700082243,0.480565239116609,0.4753519812323955,0.4701387233481821,0.46492546546396907,0.45971220757975517,0.4544989496955417,0.4492856918113278,0.4440724339271148,0.43885917604290225,0.43364591815868836,0.4284326602744749,0.423219402390261,0.41800614450604756,0.41279288662183455,0.4075796287376211,0.4023663708534072,0.3971531129691942,0.39193985508498164,0.38672659720076774,0.38151333931655385,0.3763000814323404,0.37108682354812694,0.36587356566391394,0.3606603077797005,0.3554470498954866,0.3502337920112736,0.3450205341270606,0.3398072762428471,0.3345940183586332,0.3293807604744198,0.3241675025902063,0.3189542447059929,0.31374098682177987,0.30852772893756597,0.30331447105335296,0.29810121316913996,0.2928879552849256,0.2876746974007126,0.28246143951649916,0.2772481816322857,0.27203492374807225,0.2668216658638588,0.2616084079796449,0.2563951500954319,0.2511818922112189,0.245968634327005,0.24075537644279155,0.23554211855857854,0.2303288606743651,0.22511560279015164,0.21990234490593774,0.21468908702172385,0.20947582913751128,0.20426257125329828,0.19904931336908438,0.19383605548487093,0.18862279760065792,0.18340953971644447,0.17819628183223057,0.17298302394801712,0.16776976606380323,0.16255650817959066,0.15734325029537766,0.15212999241116376,0.1469167345269503,0.14170347664273641,0.13649021875852385,0.13127696087430996,0.1260637029900965,0.12085044510588305,0.1156371872216696,0.11042392933745615,0.10521067145324314,0.09999741356903014,0.0947841556848158,0.08957089780060279,0.08435763991638934,0.07914438203217589,0.07393112414796243,0.06871786626374898,0.06350460837953464,0.058291350495322525,0.05307809261110952,0.04786483472689518,0.04265157684268173,0.03743831895846872,0.03222506107425527,0.027011803190041817,0.021798545305828365,0.016585287421614026,0.011372029537401462,0.006158771653188455,0.0009455137689745596,-0.004267744115238836,-0.009481001999452288,-0.014694259883665295,-0.019907517767878746,-0.025120775652091754,-0.030334033536305205,-0.03554729142051821,-0.04076054930473211,-0.04597380718894556,-0.051187065073159455,-0.05640032295737246,-0.061613580841585025,-0.06682683872579892,-0.07204009661001237,-0.07725335449422627,-0.08246661237843972,-0.08767987026265273,-0.09289312814686618,-0.09810638603108007,-0.10331964391529308,-0.10853290179950564,-0.11374615968371954,-0.11895941756793343,-0.12417267545214689,-0.12938593333636034,-0.1345991912205738,-0.1398124491047868,-0.1450257069890007,-0.1502389648732137,-0.1554522227574267,-0.1606654806416406,-0.16587873852585405,-0.1710919964100675,-0.17630525429428096,-0.1815185121784944,-0.18673177006270741,-0.19194502794692087,-0.19715828583113476,-0.20237154371534866,-0.20758480159956166,-0.21279805948377423,-0.21801131736798812,-0.22322457525220157,-0.22843783313641502,-0.23365109102062892,-0.23886434890484148,-0.24407760678905538,-0.24929086467326927,-0.2545041225574823,-0.25971738044169485,-0.26493063832590874,-0.2701438962101222,-0.27535715409433564,-0.28057041197854954,-0.28578366986276255,-0.290996927746976,-0.2962101856311899,-0.3014234435154029,-0.3066367013996159,-0.31184995928382936,-0.3170632171680428,-0.3222764750522567,-0.32748973293647016,-0.3327029908206836,-0.3379162487048966,-0.3431295065891105,-0.3483427644733235,-0.3535560223575365,-0.35876928024175087,-0.3639825381259639,-0.3691957960101773,-0.3744090538943908,-0.3796223117786042,-0.3848355696628177,-0.39004882754703113,-0.39526208543124414,-0.40047534331545714,-0.4056886011996715,-0.41090185908388493,-0.41611511696809794,-0.4213283748523114,-0.42654163273652485,-0.4317548906207383,-0.43696814850495264,-0.44218140638916476,-0.44739466427337776,-0.4526079221575921,-0.45782118004180555,-0.46303443792601856,-0.468247695810232,-0.47346095369444546,-0.4786742115786589,-0.48388746946287325,-0.4891007273470858,-0.4943139852312988,-0.4995272431155127,-0.5047405009997261,-0.5099537588839396,-0.5151670167681526,-0.520380274652366,-0.5255935325365799,-0.5308067904207934,-0.5360200483050068,-0.5412333061892203,-0.5464465640734333,-0.5516598219576463,-0.5568730798418602,-0.5620863377260732,-0.5672995956102871,-0.5725128534945005,-0.577726111378714,-0.5829393692629274,-0.5881526271471413,-0.5933658850313539,-0.5985791429155669,-0.6037924007997812,-0.6090056586839947,-0.6142189165682077,-0.6194321744524212,-0.6246454323366346,-0.6298586902208481,-0.6350719481050624,-0.6402852059892754,-0.6454984638734875,-0.650711721757701,-0.6559249796419149,-0.6611382375261283,-0.6663514954103418,-0.6715647532945552,-0.6767780111787678,-0.6819912690629812,-0.6872045269471947,-0.6924177848314081,-0.697631042715622,-0.7028443005998355,-0.7080575584840489,-0.7132708163682615,-0.7184840742524758,-0.7236973321366884,-0.7289105900209019,-0.7341238479051153,-0.7393371057893292,-0.7445503636735427,-0.749763621557757,-0.7549768794419696,-0.7601901373261821,-0.7654033952103965,-0.7706166530946104,-0.7758299109788225,-0.7810431688630359,-0.7862564267472498,-0.7914696846314633,-0.7966829425156776,-0.8018962003998902,-0.8071094582841027,-0.8123227161683175,-0.817535974052531,-0.8227492319367444,-0.827962489820957,-0.8331757477051704,-0.8383890055893839,-0.8436022634735973,-0.8488155213578108,-0.8540287792420242,-0.8592420371262381,-0.8644552950104503,-0.869668552894665,-0.8748818107788776,-0.8800950686630911,-0.8853083265473045,-0.890521584431518,-0.8957348423157314,-0.9009481001999462,-0.9061613580841588,-0.9113746159683709,-0.9165878738525857,-0.9218011317367991,-0.9270143896210117,-0.9322276475052251,-0.9374409053894386,-0.9426541632736525,-0.9478674211578668,-0.9530806790420794,-0.958293936926292,-0.9635071948105063,-0.9687204526947197,-0.9739337105789336,-0.9791469684631458,-0.9843602263473592,-0.9895734842315731,-0.9947867421157874],[-1,-0.9897168146928205,-0.9794336293856408,-0.9691504440784613,-0.9588672587712816,-0.9485840734641021,-0.9383008881569225,-0.9280177028497429,-0.9177345175425633,-0.9074513322353838,-0.8971681469282041,-0.8868849616210246,-0.876601776313845,-0.8663185910066654,-0.8560354056994858,-0.8457522203923062,-0.8354690350851266,-0.825185849777947,-0.8149026644707674,-0.8046194791635879,-0.7943362938564082,-0.7840531085492287,-0.7737699232420492,-0.7634867379348695,-0.7532035526276899,-0.7429203673205103,-0.7326371820133308,-0.7223539967061512,-0.7120708113989715,-0.7017876260917919,-0.6915044407846125,-0.6812212554774328,-0.6709380701702532,-0.6606548848630737,-0.650371699555894,-0.6400885142487145,-0.6298053289415348,-0.6195221436343553,-0.6092389583271758,-0.5989557730199961,-0.5886725877128165,-0.578389402405637,-0.5681062170984574,-0.5578230317912778,-0.5475398464840984,-0.5372566611769186,-0.5269734758697391,-0.5166902905625594,-0.5064071052553798,-0.49612391994820026,-0.4858407346410206,-0.4755575493338411,-0.46527436402666156,-0.4549911787194819,-0.4447079934123024,-0.43442480810512274,-0.4241416227979432,-0.41385843749076345,-0.4035752521835839,-0.3932920668764044,-0.38300888156922486,-0.3727256962620452,-0.3624425109548657,-0.35215932564768604,-0.3418761403405065,-0.33159295503332686,-0.32130976972614733,-0.3110265844189677,-0.30074339911178805,-0.2904602138046085,-0.28017702849742887,-0.26989384319024945,-0.2596106578830698,-0.24932747257589027,-0.23904428726871063,-0.2287611019615311,-0.21847791665435146,-0.20819473134717192,-0.19791154603999228,-0.18762836073281264,-0.1773451754256331,-0.16706199011845346,-0.15677880481127393,-0.1464956195040944,-0.13621243419691476,-0.125929248889735,-0.11564606358255569,-0.10536287827537605,-0.09507969296819663,-0.08479650766101687,-0.07451332235383723,-0.0642301370466577,-0.053946951739478055,-0.04366376643229852,-0.03338058112511888,-0.02309739581793946,-0.012814210510759705,-0.0025310252035799508,0.00775216010359947,0.018035345410779113,0.028318530717958756,0.03860171602513818,0.04888490133231782,0.05916808663949724,0.06945127194667688,0.07973445725385653,0.09001764256103617,0.10030082786821581,0.11058401317539523,0.12086719848257488,0.13115038378975452,0.14143356909693416,0.15171675440411359,0.16199993971129323,0.1722831250184731,0.18256631032565251,0.19284949563283216,0.20313268094001158,0.21341586624719122,0.22369905155437086,0.23398223686155029,0.24426542216872993,0.25454860747590957,0.264831792783089,0.27511497809026864,0.2853981633974483,0.2956813487046279,0.30596453401180757,0.316247719318987,0.32653090462616663,0.3368140899333463,0.3470972752405259,0.35738046054770534,0.367663645854885,0.3779468311620646,0.38823001646924427,0.3985132017764239,0.40879638708360333,0.419079572390783,0.4293627576979626,0.43964594300514226,0.44992912831232146,0.4602123136195011,0.47049549892668074,0.4807786842338604,0.4910618695410398,0.5013450548482195,0.5116282401553991,0.5219114254625787,0.5321946107697584,0.5424777960769378,0.5527609813841174,0.5630441666912971,0.5733273519984767,0.5836105373056562,0.5938937226128358,0.6041769079200154,0.6144600932271951,0.6247432785343747,0.6350264638415541,0.6453096491487338,0.6555928344559132,0.6658760197630931,0.6761592050702727,0.6864423903774521,0.6967255756846318,0.7070087609918112,0.7172919462989911,0.7275751316061705,0.7378583169133501,0.74814150222053,0.7584246875277094,0.7687078728348886,0.7789910581420683,0.7892742434492479,0.7995574287564275,0.8098406140636067,0.8201237993707866,0.8304069846779663,0.8406901699851459,0.8509733552923255,0.8612565405995047,0.8715397259066846,0.8818229112138642,0.8921060965210439,0.9023892818282238,0.912672467135403,0.9229556524425826,0.9332388377497622,0.9435220230569419,0.9538052083641211,0.964088393671301,0.9743715789784806,0.9846547642856602,0.9949379495928401,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.9897168146928204,0.9794336293856407,0.9691504440784611,0.9588672587712814,0.9485840734641018,0.9383008881569221,0.9280177028497425,0.9177345175425629,0.9074513322353832,0.8971681469282045,0.8868849616210248,0.8766017763138452,0.8663185910066655,0.8560354056994859,0.8457522203923062,0.8354690350851266,0.825185849777947,0.8149026644707673,0.8046194791635877,0.794336293856408,0.7840531085492284,0.7737699232420487,0.7634867379348691,0.7532035526276895,0.7429203673205098,0.7326371820133302,0.7223539967061505,0.7120708113989718,0.7017876260917921,0.6915044407846125,0.6812212554774328,0.6709380701702532,0.6606548848630736,0.6503716995558939,0.6400885142487143,0.6298053289415346,0.619522143634355,0.6092389583271753,0.5989557730199957,0.588672587712816,0.5783894024056364,0.5681062170984568,0.5578230317912771,0.5475398464840975,0.5372566611769178,0.5269734758697382,0.5166902905625594,0.5064071052553798,0.49612391994820015,0.4858407346410205,0.47555754933384087,0.4652743640266612,0.4549911787194816,0.44470799341230194,0.4344248081051223,0.42414162279794265,0.413858437490763,0.40357525218358337,0.3932920668764037,0.3830088815692241,0.37272569626204444,0.3624425109548648,0.3521593256476869,0.3418761403405073,0.33159295503332764,0.321309769726148,0.31102658441896835,0.3007433991117887,0.29046021380460907,0.2801770284974294,0.2698938431902498,0.25961065788307014,0.2493274725758905,0.23904428726871085,0.2287611019615312,0.21847791665435157,0.20819473134717192,0.19791154603999228,0.18762836073281353,0.17734517542563388,0.16706199011845424,0.1567788048112746,0.14649561950409495,0.1362124341969153,0.12592924888973567,0.11564606358255602,0.10536287827537638,0.09507969296819674,0.0847965076610171,0.07451332235383745,0.06423013704665781,0.053946951739478166,0.04366376643229852,0.03338058112511888,0.023097395817939237,0.012814210510759594,0.0025310252035799508,-0.007752160103598804,-0.018035345410778447,-0.02831853071795809,-0.03860171602513773,-0.048884901332317376,-0.05916808663949702,-0.06945127194667666,-0.0797344572538563,-0.09001764256103595,-0.10030082786821559,-0.11058401317539523,-0.12086719848257488,-0.13115038378975452,-0.14143356909693416,-0.1517167544041138,-0.16199993971129345,-0.1722831250184731,-0.18256631032565274,-0.1928494956328315,-0.20313268094001113,-0.21341586624719078,-0.22369905155437042,-0.23398223686155006,-0.2442654221687297,-0.25454860747590935,-0.264831792783089,-0.27511497809026864,-0.2853981633974483,-0.2956813487046279,-0.30596453401180757,-0.3162477193189872,-0.32653090462616685,-0.3368140899333465,-0.34709727524052614,-0.3573804605477058,-0.3676636458548854,-0.37794683116206507,-0.3882300164692438,-0.39851320177642346,-0.4087963870836031,-0.41907957239078275,-0.4293627576979624,-0.43964594300514204,-0.4499291283123217,-0.4602123136195022,-0.47049549892668097,-0.4807786842338597,-0.49106186954104025,-0.5013450548482199,-0.5116282401553995,-0.5219114254625792,-0.5321946107697588,-0.5424777960769385,-0.552760981384119,-0.5630441666912978,-0.5733273519984756,-0.5836105373056562,-0.5938937226128358,-0.6041769079200154,-0.6144600932271951,-0.6247432785343747,-0.6350264638415544,-0.645309649148734,-0.6555928344559137,-0.6658760197630942,-0.6761592050702729,-0.6864423903774517,-0.6967255756846322,-0.7070087609918119,-0.7172919462989915,-0.7275751316061712,-0.7378583169133508,-0.7481415022205304,-0.758424687527711,-0.7687078728348888,-0.7789910581420676,-0.7892742434492481,-0.7995574287564278,-0.8098406140636074,-0.820123799370787,-0.8304069846779667,-0.8406901699851463,-0.8509733552923269,-0.8612565405995056,-0.8715397259066844,-0.8818229112138649,-0.8921060965210446,-0.9023892818282242,-0.9126724671354038,-0.9229556524425835,-0.9332388377497614,-0.943522023056941,-0.9538052083641206,-0.9640883936713003,-0.9743715789784799,-0.9846547642856605,-0.9949379495928392,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-0.9914061833810488,-0.9828123667620975,-0.9742185501431463,-0.9656247335241951,-0.9570309169052439,-0.9484371002862926,-0.9398432836673414,-0.9312494670483902,-0.922655650429439,-0.9140618338104877,-0.9054680171915365,-0.8968742005725853,-0.888280383953634,-0.8796865673346828,-0.8710927507157316,-0.8624989340967804,-0.853905117477829,-0.8453113008588778,-0.8367174842399266,-0.8281236676209753,-0.8195298510020241,-0.8109360343830729,-0.8023422177641217,-0.7937484011451705,-0.7851545845262192,-0.776560767907268,-0.7679669512883168,-0.7593731346693655,-0.7507793180504143,-0.7421855014314631,-0.7335916848125119,-0.7249978681935606,-0.7164040515746094,-0.7078102349556581,-0.6992164183367069,-0.6906226017177557,-0.6820287850988045,-0.6734349684798533,-0.6648411518609021,-0.6562473352419508,-0.6476535186229995,-0.6390597020040483,-0.6304658853850971,-0.621872068766146,-0.6132782521471947,-0.6046844355282435,-0.5960906189092922,-0.587496802290341,-0.5789029856713896,-0.5703091690524384,-0.5617153524334872,-0.553121535814536,-0.5445277191955848,-0.5359339025766336,-0.5273400859576823,-0.518746269338731,-0.5101524527197798,-0.5015586361008286,-0.4929648194818774,-0.4843710028629262,-0.475777186243975,-0.4671833696250238,-0.4585895530060725,-0.4499957363871212,-0.44140191976817,-0.4328081031492188,-0.4242142865302675,-0.4156204699113163,-0.4070266532923651,-0.3984328366734138,-0.3898390200544627,-0.3812452034355115,-0.3726513868165602,-0.364057570197609,-0.3554637535786578,-0.34686993695970647,-0.33827612034075527,-0.32968230372180407,-0.32108848710285276,-0.31249467048390156,-0.30390085386495036,-0.29530703724599905,-0.28671322062704796,-0.27811940400809665,-0.2695255873891452,-0.26093177077019425,-0.25233795415124305,-0.24374413753229196,-0.23515032091334054,-0.22655650429438934,-0.21796268767543803,-0.20936887105648683,-0.20077505443753563,-0.19218123781858432,-0.18358742119963323,-0.17499360458068192,-0.1663997879617305,-0.1578059713427794,-0.1492121547238282,-0.1406183381048769,-0.1320245214859257,-0.1234307048669746,-0.1148368882480233,-0.1062430716290721,-0.0976492550101209,-0.08905543839116958,-0.08046162177221827,-0.07186780515326718,-0.06327398853431587,-0.05468017191536467,-0.04608635529641347,-0.03749253867746216,-0.02889872205851096,-0.02030490543955965,-0.01171108882060845,-0.0031172722016572507,0.005476544417293949,0.01407036103624515,0.02266417765519657,0.03125799427414755,0.03985181089309875,0.04844562751204995,0.05703944413100137,0.06563326074995235,0.07422707736890377,0.08282089398785497,0.09141471060680617,0.10000852722575759,0.10860234384470879,0.11719616046365999,0.1257899770826112,0.1343837937015624,0.1429776103205136,0.15157142693946501,0.16016524355841621,0.16875906017736741,0.17735287679631861,0.18594669341526981,0.19454051003422101,0.20313432665317244,0.21172814327212341,0.22032195989107461,0.22891577651002581,0.23750959312897701,0.24610340974792821,0.25469722636687964,0.26329104298583084,0.27188485960478204,0.28047867622373324,0.28907249284268444,0.29766630946163564,0.30626012608058706,0.31485394269953826,0.32344775931848946,0.33204157593744066,0.34063539255639186,0.34922920917534306,0.3578230257942945,0.3664168424132457,0.3750106590321969,0.38360447565114786,0.3921982922700993,0.4007921088890505,0.4093859255080019,0.4179797421269531,0.4265735587459041,0.4351673753648555,0.4437611919838067,0.4523550086027579,0.46094882522170955,0.4695426418406605,0.4781364584596115,0.4867302750785627,0.4953240916975139,0.5039179083164651,0.5125117249354161,0.5211055415543677,0.5296993581733189,0.5382931747922701,0.5468869914112213,0.5554808080301723,0.564074624649124,0.5726684412680751,0.5812622578870263,0.5898560745059778,0.5984498911249287,0.60704370774388,0.6156375243628314,0.6242313409817826,0.6328251576007335,0.641418974219685,0.6500127908386362,0.6586066074575874,0.667200424076539,0.67579424069549,0.6843880573144412,0.6929818739333924,0.7015756905523436,0.7101695071712952,0.7187633237902462,0.7273571404091974,0.7359509570281486,0.7445447736470998,0.7531385902660508,0.7617324068850018,0.7703262235039534,0.7789200401229046,0.7875138567418558,0.7961076733608072,0.8047014899797582,0.8132953065987094,0.8218891232176608,0.830482939836612,0.8390767564555635,0.8476705730745144,0.8562643896934656,0.8648582063124168,0.8734520229313683,0.8820458395503192,0.8906396561692707,0.8992334727882219,0.907827289407173,0.9164211060261247,0.9250149226450757,0.9336087392640269,0.9422025558829781,0.9507963725019293,0.9593901891208807,0.9679840057398317,0.9765778223587831,0.9851716389777343,0.9937654555966855,0.9992843985958434,0.9966777696537366,0.9940711407116299,0.9914645117695232,0.9888578828274166,0.9862512538853097,0.983644624943203,0.9810379960010964,0.9784313670589897,0.975824738116883,0.9732181091747762,0.9706114802326696,0.9680048512905629,0.9653982223484561,0.9627915934063495,0.9601849644642428,0.9575783355221361,0.9549717065800293,0.9523650776379226,0.9497584486958159,0.9471518197537091,0.9445451908116025,0.9419385618694958,0.939331932927389,0.9367253039852823,0.9341186750431756,0.931512046101069,0.9289054171589622,0.9262987882168556,0.9236921592747488,0.9210855303326421,0.9184789013905355,0.9158722724484286,0.913265643506322,0.9106590145642153,0.9080523856221085,0.9054457566800018,0.9028391277378951,0.9002324987957885,0.8976258698536818,0.8950192409115751,0.8924126119694683,0.8898059830273616,0.887199354085255,0.8845927251431481,0.8819860962010415,0.8793794672589348,0.8767728383168281,0.8741662093747213,0.8715595804326147,0.8689529514905081,0.8663463225484014,0.8637396936062947,0.8611330646641879,0.8585264357220812,0.8559198067799746,0.8533131778378678,0.8507065488957611,0.8480999199536544,0.8454932910115476,0.8428866620694411,0.8402800331273342,0.8376734041852276,0.8350667752431209,0.8324601463010142,0.8298535173589074,0.8272468884168007,0.8246402594746941,0.8220336305325873,0.8194270015904807,0.8168203726483739,0.8142137437062671,0.8116071147641606,0.8090004858220537,0.8063938568799471,0.8037872279378404,0.8011805989957337,0.798573970053627,0.7959673411115202,0.7933607121694136,0.7907540832273068,0.7881474542852002,0.7855408253430934,0.7829341964009866,0.78032756745888,0.7777209385167733,0.7751143095746666,0.7725076806325599,0.769901051690453,0.7672944227483466,0.7646877938062397,0.762081164864133,0.7594745359220263,0.7568679069799197,0.754261278037813,0.7516546490957061,0.7490480201535996,0.7464413912114928,0.7438347622693859,0.7412281333272794,0.7386215043851727,0.736014875443066,0.7334082465009593,0.7308016175588525,0.7281949886167458,0.7255883596746392,0.7229817307325324,0.7203751017904255,0.7177684728483191,0.7151618439062123,0.7125552149641057,0.709948586021999,0.7073419570798924,0.7047353281377856,0.7021286991956789,0.6995220702535723,0.6969154413114655,0.6943088123693588,0.6917021834272519,0.6890955544851456,0.6864889255430386,0.6838822966009319,0.6812756676588253,0.6786690387167185,0.676062409774612,0.6734557808325051,0.6708491518903983,0.6682425229482918,0.6656358940061848,0.6630292650640786,0.6604226361219716,0.6578160071798649,0.6552093782377582,0.6526027492956514,0.6499961203535448,0.647389491411438,0.6447828624693315,0.6421762335272245,0.639569604585118,0.6369629756430113,0.6343563467009045,0.6317497177587978,0.6291430888166911,0.6265364598745844,0.6239298309324777,0.6213232019903709,0.6187165730482642,0.6161099441061577,0.6135033151640508,0.6108966862219442,0.6082900572798373,0.6056834283377308,0.603076799395624,0.6004701704535174,0.5978635415114106,0.5952569125693037,0.5926502836271974,0.5900436546850905,0.5874370257429837,0.584830396800877,0.5822237678587703,0.5796171389166637,0.5770105099745568,0.5744038810324503,0.5717972520903435,0.5691906231482367,0.5665839942061303,0.5639773652640233,0.5613707363219167,0.55876410737981,0.5561574784377032,0.5535508494955965,0.5509442205534898,0.5483375916113832,0.5457309626692766,0.5431243337271698,0.540517704785063,0.5379110758429566,0.5353044469008497,0.5326978179587429,0.5300911890166363,0.5274845600745296,0.524877931132423,0.5222713021903163,0.5196646732482094,0.5170580443061026,0.5144514153639962,0.5118447864218894,0.5092381574797826,0.506631528537676,0.5040248995955692,0.5014182706534625,0.49881164171135584,0.4962050127692491,0.4935983838271425,0.49099175488503555,0.48838512594292915,0.4857784970008223,0.4831718680587156,0.48056523911660887,0.47795861017450214,0.4753519812323955,0.4727453522902888,0.47013872334818196,0.46753209440607524,0.46492546546396873,0.462318836521862,0.45971220757975517,0.45710557863764845,0.45449894969554183,0.451892320753435,0.4492856918113284,0.44667906286922165,0.4440724339271147,0.4414658049850084,0.4388591760429015,0.43625254710079486,0.43364591815868814,0.4310392892165815,0.4284326602744747,0.42582603133236796,0.42321940239026135,0.4206127734481545,0.4180061445060478,0.4153995155639413,0.41279288662183455,0.4101862576797277,0.407579628737621,0.4049729997955144,0.40236637085340765,0.39975974191130104,0.3971531129691942,0.39454648402708736,0.39193985508498097,0.38933322614287424,0.3867265972007674,0.3841199682586609,0.3815133393165542,0.37890671037444745,0.3763000814323406,0.3736934524902339,0.3710868235481274,0.36848019460602066,0.3658735656639136,0.3632669367218073,0.3606603077797004,0.35805367883759387,0.35544704989548703,0.3528404209533803,0.3502337920112736,0.34762716306916674,0.34502053412706024,0.3424139051849535,0.3398072762428468,0.3372006473007403,0.33459401835863345,0.3319873894165267,0.32938076047442,0.32677413153231316,0.32416750259020644,0.32156087364809993,0.3189542447059932,0.31634761576388615,0.31374098682178,0.3111343578796729,0.3085277289375664,0.3059210999954597,0.30331447105335285,0.3007078421112461,0.2981012131691393,0.2954945842270329,0.29288795528492606,0.29028132634281933,0.2876746974007126,0.2850680684586058,0.28246143951649927,0.27985481057439254,0.2772481816322858,0.274641552690179,0.27203492374807225,0.26942829480596575,0.266821665863859,0.2642150369217522,0.26160840797964546,0.25900177903753896,0.25639515009543223,0.2537885211533254,0.25118189221121867,0.24857526326911195,0.24596863432700544,0.2433620053848986,0.24075537644279188,0.23814874750068515,0.23554211855857832,0.2329354896164718,0.2303288606743651,0.22772223173225836,0.22511560279015153,0.2225089738480448,0.2199023449059383,0.21729571596383157,0.21468908702172473,0.212082458079618,0.20947582913751128,0.20686920019540478,0.20426257125329794,0.20165594231119122,0.1990493133690845,0.196442684426978,0.19383605548487126,0.19122942654276442,0.1886227976006577,0.18601616865855097,0.18340953971644447,0.18080291077433763,0.1781962818322309,0.17558965289012418,0.17298302394801734,0.17037639500591084,0.16776976606380412,0.1651631371216974,0.16255650817959055,0.15994987923748383,0.15734325029537732,0.1547366213532706,0.15212999241116376,0.14952336346905704,0.1469167345269503,0.1443101055848438,0.14170347664273697,0.13909684770063047,0.13649021875852374,0.13388358981641724,0.1312769608743105,0.12867033193220367,0.12606370299009695,0.12345707404799022,0.12085044510588372,0.118243816163777,0.11563718722167016,0.11303055827956343,0.1104239293374567,0.1078173003953502,0.10521067145324337,0.10260404251113664,0.09999741356902991,0.09739078462692308,0.09478415568481657,0.09217752674270985,0.08957089780060312,0.08696426885849629,0.08435763991638956,0.08175101097428306,0.07914438203217633,0.0765377530900695,0.07393112414796277,0.07132449520585626,0.06871786626374954,0.0661112373216427,0.06350460837953598,0.06089797943742925,0.05829135049532275,0.05568472155321591,0.053078092611109184,0.05047146366900246,0.04786483472689562,0.04525820578478912,0.04265157684268239,0.04004494790057567,0.03743831895846883,0.034831690016362105,0.0322250610742556,0.029618432132148875,0.02701180319004204,0.024405174247935313,0.021798545305828587,0.019191916363722084,0.016585287421615358,0.013978658479508521,0.011372029537401795,0.008765400595295292,0.006158771653188566,0.0035521427110817294,0.0009455137689750037,-0.001661115173131833,-0.004267744115238337,-0.006874373057345062,-0.009481001999451788,-0.012087630941558514,-0.01469425988366524,-0.017300888825771743,-0.01990751776787869,-0.022514146709985416,-0.025120775652092142,-0.027727404594198868,-0.03033403353630537,-0.0329406624784121,-0.03554729142051882,-0.03815392036262577,-0.040760549304732496,-0.043367178246839,-0.045973807188945726,-0.04858043613105245,-0.05118706507315918,-0.0537936940152659,-0.056400322957372406,-0.05900695189947913,-0.06161358084158608,-0.0642202097836928,-0.06682683872579975,-0.06943346766790603,-0.07204009661001254,-0.07464672555211949,-0.07725335449422621,-0.07985998343633272,-0.08246661237843966,-0.08507324132054639,-0.08767987026265311,-0.09028649920476006,-0.09289312814686634,-0.09549975708897285,-0.0981063860310798,-0.10071301497318674,-0.10331964391529347,-0.10592627285739997,-0.1085329017995067,-0.11113953074161342,-0.11374615968372015,-0.11635278862582688,-0.11895941756793382,-0.12156604651004033,-0.12417267545214661,-0.12677930439425378,-0.12938593333636028,-0.131992562278467,-0.13459919122057373,-0.13720582016268046,-0.1398124491047874,-0.14241907804689435,-0.14502570698900064,-0.14763233593110714,-0.1502389648732141,-0.1528455938153208,-0.15545222275742732,-0.15805885169953404,-0.16066548064164077,-0.16327210958374772,-0.16587873852585466,-0.16848536746796094,-0.17109199641006745,-0.1736986253521744,-0.17630525429428112,-0.17891188323638785,-0.18151851217849435,-0.1841251411206013,-0.1867317700627078,-0.18933839900481453,-0.19194502794692103,-0.19455165688902776,-0.19715828583113448,-0.19976491477324143,-0.20237154371534793,-0.20497817265745422,-0.20758480159956139,-0.2101914305416681,-0.21279805948377484,-0.21540468842588156,-0.21801131736798807,-0.2206179463100948,-0.22322457525220196,-0.22583120419430824,-0.22843783313641453,-0.2310444620785217,-0.23365109102062842,-0.23625771996273515,-0.23886434890484187,-0.2414709778469486,-0.2440776067890551,-0.24668423573116227,-0.24929086467326877,-0.2518974936153753,-0.254504122557482,-0.25711075149958873,-0.25971738044169546,-0.2623240093838022,-0.2649306383259089,-0.2675372672680154,-0.27014389621012236,-0.2727505251522291,-0.27535715409433603,-0.27796378303644254,-0.2805704119785488,-0.28317704092065576,-0.2857836698627625,-0.28839029880486944,-0.29099692774697616,-0.29360355668908267,-0.2962101856311894,-0.29881681457329634,-0.30142344351540284,-0.3040300724575091,-0.3066367013996161,-0.309243330341723,-0.31184995928382975,-0.3144565882259365,-0.317063217168043,-0.3196698461101497,-0.32227647505225665,-0.32488310399436315,-0.32748973293646966,-0.3300963618785764,-0.33270299082068333,-0.33530961976279006,-0.3379162487048968,-0.3405228776470035,-0.34312950658911,-0.34573613553121696,-0.34834276447332346,-0.35094939341542997,-0.35355602235753714,-0.35616265129964364,-0.35876928024175037,-0.3613759091838571,-0.3639825381259638,-0.36658916706807054,-0.3691957960101775,-0.371802424952284,-0.3744090538943905,-0.37701568283649745,-0.37962231177860417,-0.3822289407207107,-0.3848355696628174,-0.3874421986049241,-0.3900488275470311,-0.392655456489138,-0.3952620854312443,-0.3978687143733508,-0.40047534331545775,-0.4030819722575645,-0.405688601199671,-0.4082952301417777,-0.41090185908388466,-0.4135084880259914,-0.41611511696809833,-0.4187217459102046,-0.4213283748523111,-0.42393500379441806,-0.4265416327365248,-0.42914826167863174,-0.431754890620738,-0.43436151956284497,-0.4369681485049517,-0.4395747774470584,-0.44218140638916514,-0.44478803533127187,-0.4473946642733784,-0.4500012932154849,-0.45260792215759205,-0.45521455109969855,-0.4578211800418053,-0.460427808983912,-0.4630344379260187,-0.46564106686812545,-0.4682476958102326,-0.4708543247523387,-0.4734609536944452,-0.47606758263655236,-0.4786742115786591,-0.4812808405207656,-0.4838874694628723,-0.48649409840497904,-0.48910072734708576,-0.49170735628919293,-0.4943139852312992,-0.4969206141734057,-0.49952724311551266,-0.5021338720576194,-0.5047405009997261,-0.5073471299418326,-0.5099537588839393,-0.5125603878260458,-0.5151670167681526,-0.5177736457102591,-0.520380274652366,-0.5229869035944728,-0.5255935325365797,-0.5282001614786862,-0.5308067904207925,-0.5334134193628994,-0.5360200483050062,-0.5386266772471131,-0.5412333061892198,-0.5438399351313263,-0.5464465640734331,-0.54905319301554,-0.5516598219576465,-0.5542664508997528,-0.5568730798418597,-0.5594797087839667,-0.5620863377260734,-0.5646929666681801,-0.5672995956102869,-0.5699062245523934,-0.5725128534945003,-0.5751194824366068,-0.5777261113787133,-0.5803327403208203,-0.582939369262927,-0.5855459982050337,-0.5881526271471404,-0.5907592560892472,-0.5933658850313537,-0.5959725139734604,-0.5985791429155674,-0.6011857718576743,-0.6037924007997808,-0.6063990297418871,-0.609005658683994,-0.6116122876261008,-0.6142189165682075,-0.6168255455103144,-0.6194321744524207,-0.6220388033945277,-0.6246454323366346,-0.6272520612787411,-0.6298586902208474,-0.6324653191629543,-0.6350719481050611,-0.6376785770471678,-0.6402852059892747,-0.6428918349313812,-0.645498463873488,-0.6481050928155949,-0.6507117217577014,-0.6533183506998079,-0.6559249796419147,-0.6585316085840214,-0.6611382375261283,-0.663744866468235,-0.6663514954103418,-0.6689581243524483,-0.6715647532945552,-0.6741713822366617,-0.6767780111787682,-0.6793846401208754,-0.6819912690629819,-0.6845978980050886,-0.6872045269471954,-0.6898111558893021,-0.6924177848314088,-0.6950244137735155,-0.697631042715622,-0.7002376716577285,-0.7028443005998357,-0.7054509295419424,-0.7080575584840489,-0.7106641874261557,-0.7132708163682624,-0.7158774453103691,-0.7184840742524763,-0.7210907031945823,-0.7236973321366889,-0.726303961078796,-0.7289105900209027,-0.7315172189630093,-0.734123847905116,-0.7367304768472227,-0.7393371057893294,-0.7419437347314366,-0.7445503636735429,-0.7471569926156494,-0.7497636215577563,-0.7523702504998631,-0.7549768794419698,-0.7575835083840763,-0.760190137326183,-0.76279676626829,-0.7654033952103967,-0.7680100241525034,-0.7706166530946101,-0.7732232820367166,-0.7758299109788231,-0.7784365399209301,-0.7810431688630366,-0.7836497978051435,-0.7862564267472503,-0.788863055689357,-0.7914696846314637,-0.7940763135735707,-0.796682942515677,-0.7992895714577835,-0.8018962003998906,-0.8045028293419973,-0.8071094582841039,-0.8097160872262106,-0.8123227161683173,-0.814929345110424,-0.8175359740525312,-0.8201426029946377,-0.8227492319367438,-0.8253558608788505,-0.8279624898209574,-0.8305691187630642,-0.8331757477051709,-0.8357823766472776,-0.8383890055893839,-0.8409956345314906,-0.8436022634735973,-0.8462088924157041,-0.848815521357811,-0.8514221502999177,-0.8540287792420245,-0.8566354081841308,-0.8592420371262379,-0.8618486660683442,-0.8644552950104509,-0.8670619239525577,-0.8696685528946646,-0.8722751818367713,-0.8748818107788785,-0.8774884397209848,-0.8800950686630911,-0.8827016976051982,-0.8853083265473052,-0.8879149554894112,-0.890521584431518,-0.8931282133736249,-0.8957348423157316,-0.8983414712578388,-0.9009481001999451,-0.9035547291420514,-0.9061613580841588,-0.9087679870262655,-0.9113746159683722,-0.9139812449104785,-0.9165878738525852,-0.919194502794692,-0.9218011317367987,-0.9244077606789054,-0.9270143896210121,-0.9296210185631191,-0.9322276475052251,-0.9348342764473325,-0.9374409053894388,-0.9400475343315455,-0.9426541632736523,-0.945260792215759,-0.9478674211578657,-0.9504740500999731,-0.9530806790420794,-0.9556873079841854,-0.9582939369262928,-0.9609005658683996,-0.9635071948105058,-0.9661138237526126,-0.9687204526947193,-0.9713270816368262,-0.9739337105789334,-0.9765403395210397,-0.979146968463146,-0.9817535974052531,-0.9843602263473599,-0.9869668552894668,-0.9895734842315729,-0.9921801131736796,-0.9947867421157865,-0.9973933710578937]];
			var curve = Curve;
			var out = 0;

			while(t>Math.PI*2)
		        t-=Math.PI*2;
		    while(t<0)
		        t+=Math.PI*2;

		    var div = 1/3;
			var div2 = 2/3;

			var newT = (t/(Math.PI*2))*999;

			var sin = Math.sin(t);
			var tri = curves[0][Math.floor(newT)];
			var saw = curves[2][Math.floor(newT)];
			var square = curves[1][Math.floor(newT)];


			if(l!=0){
				if(l<div)
					out = this.lerp(sin,tri,THREE.Math.mapLinear(l,0,div,0,1));
				else if(l>div&&l<div2)
					out = this.lerp(tri,saw,THREE.Math.mapLinear(l,div,div2,0,1));
				else
					out = this.lerp(saw,square,THREE.Math.mapLinear(l,div2,1,0,1));
			}

			if(l==0)
				return Math.sin(t);
			else
				return out;

		},


		comboCos:function(t,l){

			var wave = new this.Wave();

			var out = 0;

			var cos = Math.cos(t);
			var tri = (wave.TriCos(t)*-1);
			
			out = this.lerp(cos,tri,l);

			return out;

		},

		extend:function(child, parent){
			function TmpConst(){}
			TmpConst.prototype = parent.prototype;
			child.prototype = new TmpConst();
			child.prototype.constructor = child;
		},

		arraysEqual:function(a, b) {
			if (a === b) return true;
			if (a == null || b == null) return false;
			if (a.length != b.length) return false;
			for (var i = 0; i < a.length; ++i) {
			if (a[i] !== b[i]) return false;
			}
			return true;
		},

		map:THREE.Math.mapLinear,

		remap:function(val){
			return val;//(val*2)-1;//THREE.Math.mapLinear(val,-1,1,0,1);
		},

		makeNurbs:function(points,det,returnGeom,spaced){

			var extrude = extrude || false;
			var detail = det || 100;
			var returnGeo = returnGeom ? true : false;
			var sp = spaced ? true : false;

			var vertices = [];
			var nurbsCurve = [];

			// var points = [];
			console.log(sp);

			for(var k = 0 ; k < points.length; k++){

				if(points[k].length>3){

					var nurbsControlPoints = [];
					var nurbsKnots = [];
					var nurbsDegree = 3;

					for ( var i = 0; i <= nurbsDegree; i ++ ) {
						nurbsKnots.push( 0 );
					}


					for ( var i = 0, j = points[k].length; i < j ; i ++ ) {
						var vec = new THREE.Vector4(
								points[k][i].x,
								points[k][i].y,
								points[k][i].z,
								1 // weight of control point: higher means stronger attraction
							);

						// if(extrude)
						//     vec.z+=this.off;

						nurbsControlPoints.push(vec);

						var knot = ( i + 1 ) / ( j - nurbsDegree );
						nurbsKnots.push( THREE.Math.clamp( knot, 0, 1 ) );

					}

					nurbsCurve = new THREE.NURBSCurve(nurbsDegree, nurbsKnots, nurbsControlPoints);
					if(sp)
						vertices = nurbsCurve.getSpacedPoints(detail);
					else
						vertices = nurbsCurve.getPoints(detail);

				}
			}

			// console.log(nurbsCurve);

			if(returnGeo)
				return vertices;
			else
				return nurbsCurve;
		},

		saveGCode:function(arr,scalar) {

			var minX = 0;
			var minY = 0;
			var minZ = 0;

			console.log(arr);

			for(var i = 0 ; i < arr.length ; i++){
				for(j = 0 ; j < arr[i].length ; j++){
					if(minX>arr[i][j].x)
						minX = arr[i][j].x;
					if(minY>arr[i][j].y)
						minY = arr[i][j].y;
					if(minZ>arr[i][j].z)
						minZ = arr[i][j].z;
				}
			}

			MinX = minX;
			MinY = minY;


			MinX*=scalar;
			MinY*=scalar;

			// var output = " \nM73 P0 (enable build progress)\nG21 (set units to mm)\nG90 (set positioning to absolute)\nG10 P1 X-16.5 Y0 Z0 (Designate T0 Offset)\nG55 (Recall offset cooridinate system)\n(**** begin homing ****)\nG162 X Y F2500 (home XY axes maximum)\nG161 Z F1100 (home Z axis minimum)\nG92 Z-5 (set Z to -5)\nG1 Z0.0 (move Z to 0?)\nG161 Z F100 (home Z axis minimum)\nM132 X Y Z A B (Recall stored home offsets for XYZAB axis)\n(**** end homing ****)\nG1 X112 Y-73 Z155 F3300.0 (move to waiting position)\nG130 X0 Y0 A0 B0 (Lower stepper Vrefs while heating)\nM6 T0 (wait for toolhead, and HBP to reach temperature)\nM104 S230 T0 (set extruder temperature)\nM6 T0 (wait for toolhead, and HBP to reach temperature)\nG130 X127 Y127 A127 B127 (Set Stepper motor Vref to defaults)\nM108 R3.0 T0\nG0 X112 Y-73 (Position Nozzle)\nG0 Z0.2 (Position Height)\nM108 R4.0 (Set Extruder Speed)\nM101 (Start Extruder)\nG4 P1500 (Create Anchor)\n";

			var output = ";FLAVOR:UltiGCode\n;TIME:1081      \n;MATERIAL:1177      \n;MATERIAL2:0         \n\n;Layer count: 170\n;LAYER:0\nM107\nG1 F5000 X20.360 Y20.859 Z0.300 E-2.0\n;TYPE:WALL-OUTER\n";

			console.log(MinX);
			console.log(MinY);
			console.log(minZ);

			// if(spiralDiameter<0)
			//     spiralDiameter = minX*-2;

			var E = 2.0;

			for(var i = 0 ; i < arr.length ; i++){

				for(j = 0 ; j < arr[i].length ; j++){

					var zed =  arr[i][j].z * scalar;
					if(zed<0)
						zed=0;
					zed+=.3;

					var X = arr[i][j].x * scalar;
					var Y = arr[i][j].y * scalar;


					// X-=MinX;
					// Y-=MinY;
					

					// var off = 110+MinX;//getOffset();
					var eValue = 0;

					var squirt = 1;

					if(arr[i][j].z<1){
						squirt=THREE.Math.mapLinear(arr[i][j].z,0,1,.6,1);
					}

					squirt=1;

					if(j>0){

						var pX = arr[i][j-1].x * scalar;
						var pY = arr[i][j-1].y * scalar;

						// pX-=MinX;
						// pY-=MinY;


						var one = X - pX;
						var two = Y - pY;
						var dist = Math.sqrt(one*one + two*two);
						eValue = .4 * dist * .27;

					}

					E+=eValue;

					// var x = arr[i][j].x - MinX*scalar;
					// var y = arr[i][j].y - MinY*scalar;

					// x*=scalar;
					// y*=scalar;

					X+=110;
					Y+=110;
						
					output+="G1 X" + X;
					output+=" Y"  + Y;
					output+=" Z"  + zed;
					output+=" E"  + E;
					output+='\n';

				   
				}
				  
			}
			console.log("saved");
			var blob = new Blob([output], {type: "text/plain;charset=ANSI"});
			saveAs(blob, name);
		},

		saveGCodeMakerbot:function(arr,scalar) {

			// var minX = 0;
			// var minY = 0;
			// var minZ = 0;

			// console.log(arr);

			// for(var i = 0 ; i < arr.length ; i++){
			//     for(j = 0 ; j < arr[i].length ; j++){
			//         if(minX>arr[i][j].x)
			//             minX = arr[i][j].x;
			//         if(minY>arr[i][j].y)
			//             minY = arr[i][j].y;
			//         if(minZ>arr[i][j].z)
			//             minZ = arr[i][j].z;
			//     }
			// }

			// MinX = minX;
			// MinY = minY;

			var output = " \nM73 P0 (enable build progress)\nG21 (set units to mm)\nG90 (set positioning to absolute)\nG10 P1 X-16.5 Y0 Z0 (Designate T0 Offset)\nG55 (Recall offset cooridinate system)\n(**** begin homing ****)\nG162 X Y F2500 (home XY axes maximum)\nG161 Z F1100 (home Z axis minimum)\nG92 Z-5 (set Z to -5)\nG1 Z0.0 (move Z to 0?)\nG161 Z F100 (home Z axis minimum)\nM132 X Y Z A B (Recall stored home offsets for XYZAB axis)\n(**** end homing ****)\nG1 X112 Y-73 Z155 F3300.0 (move to waiting position)\nG130 X0 Y0 A0 B0 (Lower stepper Vrefs while heating)\nM6 T0 (wait for toolhead, and HBP to reach temperature)\nM104 S230 T0 (set extruder temperature)\nM6 T0 (wait for toolhead, and HBP to reach temperature)\nG130 X127 Y127 A127 B127 (Set Stepper motor Vref to defaults)\nM108 R3.0 T0\nG0 X112 Y-73 (Position Nozzle)\nG0 Z0.2 (Position Height)\nM108 R4.0 (Set Extruder Speed)\nM101 (Start Extruder)\nG4 P1500 (Create Anchor)\n";

			// var output = ";FLAVOR:UltiGCode\n;TIME:1081      \n;MATERIAL:1177      \n;MATERIAL2:0         \n\n;Layer count: 170\n;LAYER:0\nM107\nG1 F9000 X20.360 Y20.859 Z0.300 E-2.0\n;TYPE:WALL-OUTER\n";

			// console.log(MinX);
			// console.log(MinY);
			// console.log(minZ);

			// if(spiralDiameter<0)
			//     spiralDiameter = minX*-2;

			// var E = 2.0;

			for(var i = 0 ; i < arr.length ; i++){

				for(j = 0 ; j < arr[i].length ; j++){

					var zed =  arr[i][j].z * scalar;
					if(zed<0)
						zed=0;
					zed+=.3;

					var X = arr[i][j].x * scalar;
					var Y = arr[i][j].y * scalar;
					

					// var off = 110+MinX;//getOffset();
					// var eValue = 0;

					// var squirt = 1;

					// if(arr[i][j].z<1){
					//     squirt=THREE.Math.mapLinear(arr[i][j].z,0,1,.6,1);
					// }

					// squirt=1;

					// if(j>0){

					//     var pX = arr[i][j-1].x * scalar;
					//     var pY = arr[i][j-1].y * scalar;

					//     var one = X - pX;
					//     var two = Y - pY;
					//     var dist = Math.sqrt(one*one + two*two);
					//     eValue = .4 * dist * .27;

					// }

					// E+=eValue;

					// var x = arr[i][j].x;
					// var y = arr[i][j].y;

					// x*=scalar;
					// y*=scalar;

					// x+=110;
					// y+=110;
						
					output+="G1 X" + X;
					output+=" Y"  + Y;
					output+=" Z"  + zed;
					output+=" F2000";
					output+='\n';

				   
				}
				  
			}
			console.log("saved");
			var blob = new Blob([output], {type: "text/plain;charset=ANSI"});
			saveAs(blob, name);
		},

		makeFrame:function(size){

			var center = new THREE.Object3D();
			var line = new THREE.Mesh(new THREE.CylinderGeometry( 1,1),new THREE.MeshLambertMaterial(  ));
			line.position.x = -size;
			line.scale.y = 100;
			center.add(line);
			var c1 = center.clone();
			c1.rotation.z=pi;
			scene.add(c1);
			var c2 = center.clone();
			c2.rotation.z=pi*2;
			scene.add(c2);
			var c3 = center.clone();
			c3.rotation.z=pi*3;
			scene.add(c3);
			scene.add(center);
		},

		purgeObject:function(o){

			if(typeof o.parent !== 'undefined')
				o.parent.remove(o);

			o.traverse(function(obj){
				if(obj instanceof THREE.Line || obj instanceof THREE.Mesh){
					obj.geometry.dispose();
					obj.material.dispose();
					// obj.geometry.vertices = [];
				}
			});

			o = null;
		},

		compareObj:function(a,b){

			var returner = true;

			for(var k in a){
				if(b[k]!=a[k])
					returner = false;
			}

			return returner;
		},

		duplicateObject:function(a){

			var b = {};

			for(var k in a){
				b[k] = a[k];
			}

			return b;
		},

		vec : function(x,y,z){
			var X = x || 0;
			var Y = y || X;
			var Z = z || X;
			return new THREE.Vector3(X,Y,Z);
		},
		
		isUndef : function(thing){
			return thing === void 0;
		}
	};
});
